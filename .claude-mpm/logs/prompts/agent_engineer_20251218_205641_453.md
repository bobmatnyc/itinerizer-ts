---
timestamp: 2025-12-18T20:56:41.453892+00:00
type: agent_engineer
metadata: {"agent_type": "engineer", "agent_id": "engineer_bc691194-b92e-4217-8fbe-378faa708438", "session_id": "bc691194-b92e-4217-8fbe-378faa708438", "delegation_context": {"description": "Redesign Svelte dashboard layout", "timestamp": "2025-12-18T20:56:41.447535+00:00"}}
---


AGENT MEMORY - PROJECT-SPECIFIC KNOWLEDGE:
# Agent Memory: engineer
<!-- Last Updated: 2025-12-17T23:24:44.617242+00:00Z -->



INSTRUCTIONS: Review your memory above before proceeding. Apply learned patterns and avoid known mistakes.


Redesign the Svelte dashboard with the following changes. This is a significant UI overhaul.

**Location**: `viewer-svelte/src/routes/+page.svelte` and related components

## 1. Top Header Changes

Add two fixed buttons at the top:
- **Import** button (existing functionality, just move to header)
- **Build** button (new) - opens chatbot mode with blank itinerary document

## 2. Left Pane Changes

- Make the left pane **wider** (default ~350px instead of current width)
- Make it **resizable** (drag handle on right edge)
- Add a **chatbox** pinned to the bottom of the left pane
- When in **chat/build mode**: 
  - Show "List Itineraries" button pinned to top
  - Clicking returns to list view

## 3. Right Pane (Detail) - Tabbed Views

Replace the single itinerary view with **tabbed subviews**:

```svelte
<div class="tabs">
  <button class:active={activeTab === 'itinerary'}>Itinerary</button>
  <button class:active={activeTab === 'calendar'}>Calendar</button>
  <button class:active={activeTab === 'map'}>Map</button>
</div>

{#if activeTab === 'itinerary'}
  <!-- Current itinerary segment list -->
{:else if activeTab === 'calendar'}
  <!-- Day/Week/Month calendar view -->
{:else if activeTab === 'map'}
  <!-- OSM map with pins and route lines -->
{/if}
```

### Calendar Tab
- Day/Week/Month toggle
- Show segments as calendar events
- Use a simple calendar grid (no external library needed for MVP)

### Map Tab
- Use Leaflet.js with OpenStreetMap tiles
- Install: `npm install leaflet @types/leaflet`
- Show pins for each location
- Draw directional lines/arrows between consecutive locations
- Cluster pins if zoomed out

## 4. Component Structure

Create new components:
- `viewer-svelte/src/lib/components/Header.svelte` - Top bar with Import/Build
- `viewer-svelte/src/lib/components/ChatBox.svelte` - Chat input at bottom of left pane
- `viewer-svelte/src/lib/components/CalendarView.svelte` - Calendar tab content
- `viewer-svelte/src/lib/components/MapView.svelte` - Map tab content
- `viewer-svelte/src/lib/components/TabBar.svelte` - Tab navigation

## 5. Layout Structure

```
+------------------------------------------+
|  [Import] [Build]              Header    |
+------------+-----------------------------+
|            |  [Itinerary] [Calendar] [Map]|
|  List OR   |                             |
|  Chat Mode |    Detail Content           |
|            |    (based on active tab)    |
|            |                             |
+------------+                             |
| [Chat Box] |                             |
+------------+-----------------------------+
```

## 6. State Management

Use Svelte 5 runes:
```typescript
let viewMode = $state<'list' | 'chat'>('list');
let activeTab = $state<'itinerary' | 'calendar' | 'map'>('itinerary');
let leftPaneWidth = $state(350);
```

## Technical Notes

- Use CSS Grid or Flexbox for layout
- Resizable pane: Use a drag handle div with mouse events
- Leaflet needs to be imported dynamically (SSR issues): `import { browser } from '$app/environment'`
- Keep existing functionality working while adding new features