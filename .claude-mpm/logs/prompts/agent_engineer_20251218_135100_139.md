---
timestamp: 2025-12-18T13:51:00.139595+00:00
type: agent_engineer
metadata: {"agent_type": "engineer", "agent_id": "engineer_bc691194-b92e-4217-8fbe-378faa708438", "session_id": "bc691194-b92e-4217-8fbe-378faa708438", "delegation_context": {"description": "Convert React viewer to SvelteKit", "timestamp": "2025-12-18T13:51:00.138926+00:00"}}
---


AGENT MEMORY - PROJECT-SPECIFIC KNOWLEDGE:
# Agent Memory: engineer
<!-- Last Updated: 2025-12-17T23:24:44.617242+00:00Z -->



INSTRUCTIONS: Review your memory above before proceeding. Apply learned patterns and avoid known mistakes.


Convert the React viewer to Svelte/SvelteKit with the following requirements:

## Current React Structure (in `/Users/masa/Projects/itinerizer-ts/viewer/`)
The existing React viewer has:
- `App.tsx` - Main app with header, sidebar list, and detail panel
- `components/ItineraryList.tsx` - List of itineraries in sidebar
- `components/ItineraryDetail.tsx` - Detail view with segments
- `components/SegmentCard.tsx` - Individual segment display with source badges
- `components/GapIndicator.tsx` - Warning for geographic gaps
- `hooks/useItineraries.ts` - React Query hooks for API calls
- `lib/api.ts` - Axios API client
- `types/index.ts` - TypeScript types

## API Endpoints (Backend at localhost:3001)
- `GET /api/itineraries` - List all itineraries
- `GET /api/itineraries/:id` - Get single itinerary
- `GET /api/models` - Get available LLM models
- `POST /api/import` - Upload PDF (multipart/form-data)
- `GET /api/costs` - Get cost summary

## Conversion Requirements

1. **Create new SvelteKit project** at `viewer-svelte/` directory:
   ```bash
   npm create svelte@latest viewer-svelte
   ```
   Choose: Skeleton project, TypeScript, ESLint, Prettier, Tailwind CSS

2. **Preserve all functionality**:
   - Two-pane layout (sidebar list + detail panel)
   - PDF upload with model selection
   - Itinerary list with tags, dates, destinations
   - Segment cards with type-specific colors and icons
   - Source badges (ğŸ“„ Import, ğŸ¤– Agent, âœï¸ Manual)
   - Inferred segment indicators
   - Dark mode support

3. **Svelte-specific patterns**:
   - Use SvelteKit's `$app/stores` for navigation
   - Use Svelte's `fetch` API instead of Axios
   - Use `$:` reactive statements instead of useEffect
   - Use `writable` stores instead of React Query
   - Use Svelte components with `<script lang="ts">`

4. **File structure**:
   ```
   viewer-svelte/
   â”œâ”€â”€ src/
   â”‚   â”œâ”€â”€ routes/
   â”‚   â”‚   â”œâ”€â”€ +page.svelte          (main page)
   â”‚   â”‚   â””â”€â”€ +layout.svelte        (app shell)
   â”‚   â”œâ”€â”€ lib/
   â”‚   â”‚   â”œâ”€â”€ api.ts                (fetch-based API client)
   â”‚   â”‚   â”œâ”€â”€ stores/
   â”‚   â”‚   â”‚   â””â”€â”€ itineraries.ts    (Svelte stores)
   â”‚   â”‚   â””â”€â”€ components/
   â”‚   â”‚       â”œâ”€â”€ ItineraryList.svelte
   â”‚   â”‚       â”œâ”€â”€ ItineraryDetail.svelte
   â”‚   â”‚       â”œâ”€â”€ SegmentCard.svelte
   â”‚   â”‚       â””â”€â”€ GapIndicator.svelte
   â”‚   â””â”€â”€ app.css                   (Tailwind imports)
   â”œâ”€â”€ tailwind.config.js
   â””â”€â”€ package.json
   ```

5. **Key conversions**:
   - React `useState` â†’ Svelte `let` variables
   - React `useEffect` â†’ Svelte `onMount` or `$:` reactive
   - React Query â†’ Svelte stores with `writable`/`derived`
   - React props â†’ Svelte `export let`
   - React className â†’ Svelte `class`
   - React onClick â†’ Svelte `on:click`

6. **Icons**: Use `lucide-svelte` instead of `lucide-react`

7. **Environment**: Use `import.meta.env.VITE_API_URL` or SvelteKit's `$env/static/public`

## Implementation

Create all files with complete implementation. Include:
- Full TypeScript types in `src/lib/types.ts`
- API client using native fetch
- Svelte stores for state management
- All components converted to Svelte syntax
- Tailwind CSS styling (same as React version)
- Dark mode support preserved

Start by creating the SvelteKit project and then implement all components.